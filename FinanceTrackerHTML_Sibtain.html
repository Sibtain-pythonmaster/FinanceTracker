<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Personal Finance Tracker</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body class="bg-gradient-to-r from-blue-100 to-blue-200 text-gray-900">
  <div class="max-w-6xl mx-auto p-6 space-y-6">
    <h1 class="text-4xl font-bold text-center mb-4">ğŸ’° Personal Finance Tracker by Sibtain</h1>

    <!-- Balance Card -->
    <div id="balanceCard" class="p-6 bg-white rounded-2xl shadow-md text-center transition">
      <h2 class="text-xl font-semibold">ğŸ¦ Balance</h2>
      <p id="balance" class="text-3xl font-bold mt-2">$0.00</p>
    </div>

    <!-- Quick Add Buttons -->
    <div class="p-4 bg-white rounded-2xl shadow-md text-center space-x-2">
      <h2 class="font-semibold text-lg mb-2">âš¡ Quick Add Expense</h2>
      <button onclick="quickAdd('Coffee', 5)" class="bg-orange-400 text-white px-3 py-1 rounded hover:bg-orange-500">â˜• Coffee - $5</button>
      <button onclick="quickAdd('Lunch', 12)" class="bg-orange-400 text-white px-3 py-1 rounded hover:bg-orange-500">ğŸ” Lunch - $12</button>
      <button onclick="quickAdd('Transport', 10)" class="bg-orange-400 text-white px-3 py-1 rounded hover:bg-orange-500">ğŸšŒ Transport - $10</button>
    </div>

    <!-- Progress Bar -->
    <div class="p-4 bg-white rounded-2xl shadow-md">
      <h2 class="text-lg font-semibold mb-2">ğŸ“Š Spending vs Savings</h2>
      <div class="w-full bg-gray-200 rounded-full h-4">
        <div id="progressBar" class="bg-green-500 h-4 rounded-full transition-all duration-500" style="width: 100%"></div>
      </div>
    </div>

    <!-- Forms -->
    <div class="grid md:grid-cols-2 gap-6">
      <div class="p-4 bg-white rounded-2xl shadow-md">
        <h2 class="font-semibold text-lg mb-2">â• Add Deposit</h2>
        <form id="depositForm" class="space-y-2">
          <input type="number" step="0.01" min="0" placeholder="Amount" class="w-full border rounded-lg p-2" required>
          <button class="w-full bg-green-500 text-white rounded-lg p-2 hover:bg-green-600">Add Deposit</button>
        </form>
      </div>
      <div class="p-4 bg-white rounded-2xl shadow-md">
        <h2 class="font-semibold text-lg mb-2">ğŸ’¸ Add Expense</h2>
        <form id="expenseForm" class="space-y-2">
          <input type="text" placeholder="Category (e.g., Food, Bills)" class="w-full border rounded-lg p-2" required>
          <input type="number" step="0.01" min="0" placeholder="Amount" class="w-full border rounded-lg p-2" required>
          <button class="w-full bg-red-500 text-white rounded-lg p-2 hover:bg-red-600">Add Expense</button>
        </form>
      </div>
    </div>

    <!-- Lists -->
    <div class="grid md:grid-cols-2 gap-6">
      <div class="p-4 bg-white rounded-2xl shadow-md">
        <h2 class="font-semibold text-lg mb-2">ğŸ“ˆ Deposits</h2>
        <ul id="depositList" class="space-y-1 text-green-600"></ul>
      </div>
      <div class="p-4 bg-white rounded-2xl shadow-md">
        <h2 class="font-semibold text-lg mb-2">ğŸ’¸ Expenses</h2>
        <ul id="expenseList" class="space-y-1 text-red-600"></ul>
      </div>
    </div>

    <!-- Category Totals -->
    <div class="p-4 bg-white rounded-2xl shadow-md">
      <h2 class="font-semibold text-lg mb-2">ğŸ§® Totals by Category</h2>
      <ul id="categoryTotals" class="space-y-1"></ul>
    </div>

    <!-- Charts -->
    <div class="p-4 bg-white rounded-2xl shadow-md">
      <h2 class="font-semibold text-lg mb-2">ğŸ“Š Expenses by Category</h2>
      <canvas id="expenseChart" height="150"></canvas>
    </div>
    <div class="p-4 bg-white rounded-2xl shadow-md">
      <h2 class="font-semibold text-lg mb-2">ğŸ“… Monthly Spending Trend</h2>
      <canvas id="monthlyChart" height="150"></canvas>
    </div>

    <!-- Insights -->
    <div class="p-4 bg-white rounded-2xl shadow-md text-center">
      <h2 class="font-semibold text-lg mb-2">ğŸ“ˆ Financial Insights</h2>
      <p id="avgDaily" class="text-lg font-medium">Average Daily Spending: $0.00</p>
      <p id="savingsPercent" class="text-lg font-medium">Savings Rate: 0%</p>
      <p id="achievement" class="text-green-600 font-semibold mt-2"></p>
    </div>

    <!-- Goal Section -->
    <div class="p-4 bg-white rounded-2xl shadow-md">
      <h2 class="font-semibold text-lg mb-2">ğŸ¯ Savings Goal</h2>
      <form id="goalForm" class="space-y-2 mb-4">
        <input type="text" placeholder="Goal Name (e.g., Laptop)" class="w-full border rounded-lg p-2" required>
        <input type="number" step="0.01" min="1" placeholder="Goal Amount" class="w-full border rounded-lg p-2" required>
        <button class="w-full bg-blue-500 text-white rounded-lg p-2 hover:bg-blue-600">Set Goal</button>
      </form>

      <div id="goalArea" class="hidden">
        <p class="font-semibold">Goal: <span id="goalName"></span> - $<span id="goalAmount"></span></p>
        <div class="w-full bg-gray-200 rounded-full h-4 mt-2">
          <div id="goalProgress" class="bg-blue-500 h-4 rounded-full transition-all duration-500" style="width: 0%"></div>
        </div>
        <p class="text-sm mt-1">Progress: <span id="goalPercent">0</span>%</p>
        <p id="goalStatus" class="text-green-600 font-semibold mt-2 hidden">ğŸ‰ Goal Reached!</p>
      </div>
    </div>

    <!-- Controls -->
    <div class="text-center space-x-4">
      <button id="resetBtn" class="bg-gray-400 text-white px-4 py-2 rounded-lg hover:bg-gray-500">â™»ï¸ Reset All Data</button>
      <button id="exportBtn" class="bg-blue-400 text-white px-4 py-2 rounded-lg hover:bg-blue-500">ğŸ“¤ Export</button>
      <input type="file" id="importFile" class="hidden" accept="application/json">
      <label for="importFile" class="bg-blue-500 text-white px-4 py-2 rounded-lg cursor-pointer hover:bg-blue-600">ğŸ“¥ Import</label>
    </div>
  </div>

  <script>
    let state = JSON.parse(localStorage.getItem("financeData")) || {
      balance: 0,
      deposits: [],
      expenses: [],
      goal: { name: "", amount: 0 }
    };

    const balanceEl = document.getElementById("balance");
    const balanceCard = document.getElementById("balanceCard");
    const progressBar = document.getElementById("progressBar");
    const depositList = document.getElementById("depositList");
    const expenseList = document.getElementById("expenseList");
    const expenseChartCtx = document.getElementById("expenseChart").getContext("2d");
    const monthlyChartCtx = document.getElementById("monthlyChart").getContext("2d");
    const categoryTotals = document.getElementById("categoryTotals");
    const avgDailyEl = document.getElementById("avgDaily");
    const savingsPercentEl = document.getElementById("savingsPercent");
    const achievementEl = document.getElementById("achievement");

    const goalForm = document.getElementById("goalForm");
    const goalArea = document.getElementById("goalArea");
    const goalNameEl = document.getElementById("goalName");
    const goalAmountEl = document.getElementById("goalAmount");
    const goalProgress = document.getElementById("goalProgress");
    const goalPercentEl = document.getElementById("goalPercent");
    const goalStatus = document.getElementById("goalStatus");

    let expenseChart = new Chart(expenseChartCtx, {
      type: 'pie',
      data: { labels: [], datasets: [{ data: [], backgroundColor: [] }] },
      options: { responsive: true, plugins: { legend: { position: 'bottom' } } }
    });

    let monthlyChart = new Chart(monthlyChartCtx, {
      type: 'bar',
      data: { labels: [], datasets: [
        { label: 'Expenses', data: [], backgroundColor: 'rgba(255,99,132,0.6)' },
        { label: 'Deposits', data: [], backgroundColor: 'rgba(75,192,192,0.6)' }
      ]},
      options: { responsive: true, scales: { y: { beginAtZero: true } } }
    });

    function updateUI() {
      balanceEl.textContent = `$${state.balance.toFixed(2)}`;
      balanceCard.classList.remove("bg-green-100","bg-yellow-100","bg-red-100");
      if (state.balance > 100) balanceCard.classList.add("bg-green-100");
      else if (state.balance >= 0) balanceCard.classList.add("bg-yellow-100");
      else balanceCard.classList.add("bg-red-100");

      depositList.innerHTML = "";
      state.deposits.forEach((d, i) => {
        const li = document.createElement("li");
        li.innerHTML = `ğŸ’° +$${d.amount.toFixed(2)} (${d.date})
          <button onclick="deleteDeposit(${i})" class='text-xs text-red-500 ml-2'>âŒ</button>`;
        depositList.appendChild(li);
      });

      expenseList.innerHTML = "";
      state.expenses.forEach((e, i) => {
        const li = document.createElement("li");
        li.innerHTML = `ğŸ’¸ ${e.category}: -$${e.amount.toFixed(2)} (${e.date})
          <button onclick="deleteExpense(${i})" class='text-xs text-red-500 ml-2'>âŒ</button>`;
        expenseList.appendChild(li);
      });

      let categories = {};
      state.expenses.forEach(e => categories[e.category] = (categories[e.category] || 0) + e.amount);
      categoryTotals.innerHTML = Object.entries(categories).map(([cat, amt]) => `<li>${cat}: $${amt.toFixed(2)}</li>`).join("");

      // Charts
      expenseChart.data.labels = Object.keys(categories);
      expenseChart.data.datasets[0].data = Object.values(categories);
      expenseChart.data.datasets[0].backgroundColor = Object.keys(categories).map((_, i) => `hsl(${i * 50},70%,60%)`);
      expenseChart.update();

      updateMonthlyChart();
      updateInsights();
      updateGoalUI();

      localStorage.setItem("financeData", JSON.stringify(state));
    }

    function updateMonthlyChart() {
      const monthlyTotals = {};
      const monthlyDeposits = {};

      state.expenses.forEach(e => {
        const month = e.date.slice(0, 7);
        monthlyTotals[month] = (monthlyTotals[month] || 0) + e.amount;
      });
      state.deposits.forEach(d => {
        const month = d.date.slice(0, 7);
        monthlyDeposits[month] = (monthlyDeposits[month] || 0) + d.amount;
      });

      const months = Array.from(new Set([...Object.keys(monthlyTotals), ...Object.keys(monthlyDeposits)])).sort();
      monthlyChart.data.labels = months;
      monthlyChart.data.datasets[0].data = months.map(m => monthlyTotals[m] || 0);
      monthlyChart.data.datasets[1].data = months.map(m => monthlyDeposits[m] || 0);
      monthlyChart.update();
    }

    function updateInsights() {
      const now = new Date();
      const month = now.toISOString().slice(0,7);
      const monthExpenses = state.expenses.filter(e => e.date.startsWith(month));
      const totalExpenses = monthExpenses.reduce((a,b) => a+b.amount,0);
      const totalDeposits = state.deposits.filter(d => d.date.startsWith(month)).reduce((a,b)=>a+b.amount,0);
      const days = now.getDate();
      const avg = days ? totalExpenses / days : 0;
      avgDailyEl.textContent = `Average Daily Spending: $${avg.toFixed(2)}`;
      const savingRate = totalDeposits ? ((totalDeposits - totalExpenses)/totalDeposits)*100 : 0;
      savingsPercentEl.textContent = `Savings Rate: ${savingRate.toFixed(1)}%`;

      if (savingRate > 70) achievementEl.textContent = "ğŸ‰ Great job! Youâ€™re saving more than 70% this month!";
      else if (savingRate > 50) achievementEl.textContent = "ğŸ‘ Nice! Youâ€™re saving over half your income!";
      else if (savingRate < 0) achievementEl.textContent = "âš ï¸ Youâ€™re spending more than you earn!";
      else achievementEl.textContent = "";
    }

    function updateGoalUI() {
      if (state.goal.amount > 0) {
        goalArea.classList.remove("hidden");
        goalNameEl.textContent = state.goal.name;
        goalAmountEl.textContent = state.goal.amount.toFixed(2);
        let percent = Math.min(100, (state.balance / state.goal.amount) * 100);
        goalProgress.style.width = percent + "%";
        goalPercentEl.textContent = percent.toFixed(1);
        goalStatus.classList.toggle("hidden", state.balance < state.goal.amount);
      } else goalArea.classList.add("hidden");
    }

    function deleteDeposit(i){ state.balance -= state.deposits[i].amount; state.deposits.splice(i,1); updateUI(); }
    function deleteExpense(i){ state.balance += state.expenses[i].amount; state.expenses.splice(i,1); updateUI(); }
    function quickAdd(category, amount){ state.balance -= amount; state.expenses.push({ category, amount, date: new Date().toISOString().slice(0,10) }); updateUI(); }

    document.getElementById("depositForm").addEventListener("submit", e => {
      e.preventDefault();
      const amount = parseFloat(e.target[0].value);
      if (amount > 0) {
        state.balance += amount;
        state.deposits.push({ amount, date: new Date().toISOString().slice(0,10) });
        updateUI();
      }
      e.target.reset();
    });

    document.getElementById("expenseForm").addEventListener("submit", e => {
      e.preventDefault();
      const category = e.target[0].value.trim();
      const amount = parseFloat(e.target[1].value);
      if (category && amount > 0) {
        state.balance -= amount;
        state.expenses.push({ category, amount, date: new Date().toISOString().slice(0,10) });
        updateUI();
      }
      e.target.reset();
    });

    goalForm.addEventListener("submit", e => {
      e.preventDefault();
      const name = e.target[0].value.trim();
      const amount = parseFloat(e.target[1].value);
      if (name && amount > 0) { state.goal = { name, amount }; updateUI(); }
      e.target.reset();
    });

    document.getElementById("resetBtn").addEventListener("click", () => {
      if (confirm("Are you sure you want to reset all data?")) {
        state = { balance: 0, deposits: [], expenses: [], goal: { name: "", amount: 0 } };
        updateUI();
      }
    });

    document.getElementById("exportBtn").onclick = () => {
      const blob = new Blob([JSON.stringify(state)], { type: "application/json" });
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url; a.download = "financeData.json"; a.click();
    };

    document.getElementById("importFile").addEventListener("change", e => {
      const file = e.target.files[0];
      if (!file) return;
      const reader = new FileReader();
      reader.onload = evt => { state = JSON.parse(evt.target.result); updateUI(); };
      reader.readAsText(file);
    });

    updateUI();
  </script>
</body>
</html>
